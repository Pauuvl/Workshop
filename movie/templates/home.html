{% extends "base.html" %}

{% block title %}Inicio - Movie Reviews{% endblock %}

{% block content %}


  <!-- T√≠tulo -->
  <h1 class="mb-4 text-center">üé¨ Lista de Pel√≠culas, {{ name }}</h1>

  <!-- Formulario de b√∫squeda con Bootstrap -->
  <form method="get" class="row g-2 mb-4">
    <div class="col-md-8"> 
      <input type="text" name="searchMovie" class="form-control" placeholder="Buscar pel√≠cula..." value="{{ searchTerm }}">
    </div>
    <div class="col-md-4">
      <button type="submit" class="btn btn-green w-100">Buscar</button>
    </div>
  </form>
  <!-- Bot√≥n para ir a Sign Up -->


  <!-- Cards -->
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-3 mt-4">
    {% for movie in movies %}
      <div class="col">
        <div class="card h-100 shadow-sm border-0 rounded-3" style="max-width: 200px; margin:auto;">
          <!-- Imagen -->
          <div class="overflow-hidden">
            {% if movie.image %}
              <img src="{{ movie.image.url }}" class="card-img-top img-fluid" alt="{{ movie.title }}">
            {% else %}
              <img src="/media/movie/images/default.jpg" class="card-img-top img-fluid" alt="Imagen por defecto">
            {% endif %}
          </div>

          <!-- Cuerpo de la tarjeta -->
          <div class="card-body bg-light">
            <h5 class="card-title fw-bold text-primary">{{ movie.title }}</h5>
            <p class="card-text text-muted">{{ movie.description|truncatechars:120 }}</p>

            <!-- G√©nero y A√±o -->
            <p>
              <span class="badge bg-secondary">{{ movie.genre }}</span>
            </p>
            <p>
              <small class="text-muted">üìÖ {{ movie.year }}</small>
            </p>

            {% if movie.url %}
             <a href="{{ movie.url }}" target="_blank" class="btn btn-green btn-sm">Ver m√°s</a>

            {% endif %}
          </div>
        </div>
      </div>
    {% empty %}
      <p>No se encontraron pel√≠culas.</p>
    {% endfor %}
  </div>

  <!-- Secci√≥n de Gr√°ficas -->
  <div class="container mt-5">
    <h2 class="text-center">üìä Estad√≠sticas</h2>
    <div class="row text-center">
      <div class="col-md-6">
        <h4>Pel√≠culas por a√±o</h4>
        <img src="{% url 'movies_chart' %}?v=1" alt="Gr√°fica de pel√≠culas por a√±o" class="img-fluid border rounded shadow-sm">

      </div>
      <div class="col-md-6">
        <h4>Pel√≠culas por g√©nero (primer g√©nero)</h4>
       <img src="{% url 'movies_chart_genre' %}?v=1" alt="Gr√°fica de pel√≠culas por g√©nero" class="img-fluid border rounded shadow-sm">

      </div>
    </div>
  </div>
{% endblock %}
